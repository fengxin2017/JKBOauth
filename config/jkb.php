<?php

return [
    /*
    |--------------------------------------------------------------------------
    | token存放模型
    |--------------------------------------------------------------------------
    | 如果使用数据库需要配置相应模型.
    |
    */
    'oauth_model' => \App\JkbOauthToken::class,

    /*
    |--------------------------------------------------------------------------
    | token存放表名
    |--------------------------------------------------------------------------
    | 如果使用数据库需要配置相应表名称.
    |
    */
    'database_table_name' => 'admin_jkb_oauth_token',

    /*
    |--------------------------------------------------------------------------
    | 守卫
    |--------------------------------------------------------------------------
    | 可自定义多个guards
    | eg .
    | Route::middleware('auth:foo')->group(){}
    | Route::middleware('auth:bar')->group(){}
    */
    'guards' => [
        'foo' => [
            /*
            |--------------------------------------------------------------------------
            | 可选驱动
            |--------------------------------------------------------------------------
            | 支持 database|cache.
            */
            'driver' => 'database',

            /*
            |--------------------------------------------------------------------------
            | 缓存标签
            |--------------------------------------------------------------------------
            | 驱动使用缓存可通过分组方便管理.
            */
            'cache_tag' => 'jkb-foo',

            /*
            |--------------------------------------------------------------------------
            | 认证前中间件
            |--------------------------------------------------------------------------
            | 可以在认证前触发自定义中间件
            | eg. [App\Http\Middleware\Foo::class,App\Http\Middleware\Bar::classs]
            */
            'before_auth' => [\Fengxin2017\Oauth\Middleware\OringinCheck::class],

            /*
            |--------------------------------------------------------------------------
            | 验证前中间件
            |--------------------------------------------------------------------------
            | 检索认证模型后验证用户前触发自定义中间件
            |
            */
            'before_check' => [],

            /*
            |--------------------------------------------------------------------------
            | 缓存时间
            |--------------------------------------------------------------------------
            | 单位秒.
            */
            'cache_expire_time' => 3600,

            /*
            |--------------------------------------------------------------------------
            | retoken
            |--------------------------------------------------------------------------
            | 认证完成后是否清空当前认证用户过往已颁发token.
            */
            'retoken' => true,

            /*
            |--------------------------------------------------------------------------
            | 授信站点
            |--------------------------------------------------------------------------
            | 授信请求website列表.
            */
            'allowed_origins' => ['*'],

            /*
            |--------------------------------------------------------------------------
            | 请求头认证键名
            |--------------------------------------------------------------------------
            | 客户端请求头需携带token至此键.
            */
            'authorization_key' => 'Authorization',

            /*
            |--------------------------------------------------------------------------
            | 以下配置并不属于本扩展，用于公司内部项目请忽略
            |--------------------------------------------------------------------------
            */
            'except' => true,
            'except_header_key' => 'foo',
            'except_header_lists' => [
                'bar',
                'baz'
            ],
        ],
        'bar' => [
            /*
            |--------------------------------------------------------------------------
            | 可选驱动
            |--------------------------------------------------------------------------
            | 支持 database|cache。
            */
            'driver' => 'database',

            /*
            |--------------------------------------------------------------------------
            | 缓存标签
            |--------------------------------------------------------------------------
            | 驱动使用缓存可通过分组方便管理。
            */
            'cache_tag' => 'jkb-bar',

            /*
            |--------------------------------------------------------------------------
            | 认证前中间件
            |--------------------------------------------------------------------------
            | 可以在认证前触发自定义中间件。
            | eg. [App\Http\Middleware\Foo::class,App\Http\Middleware\Bar::classs]
            */
            'before_auth' => [\Fengxin2017\Oauth\Middleware\OringinCheck::class],

            /*
            |--------------------------------------------------------------------------
            | 验证前中间件
            |--------------------------------------------------------------------------
            | 检索认证模型后验证用户前触发自定义中间件。
            |
            */
            'before_check' => [],

            /*
            |--------------------------------------------------------------------------
            | 缓存时间
            |--------------------------------------------------------------------------
            | 单位秒。
            */
            'cache_expire_time' => 3600,

            /*
            |--------------------------------------------------------------------------
            | retoken
            |--------------------------------------------------------------------------
            | 认证完成后是否清空当前认证用户过往已颁发token。
            */
            'retoken' => true,

            /*
            |--------------------------------------------------------------------------
            | 授信站点
            |--------------------------------------------------------------------------
            | 授信请求website列表。
            */
            'allowed_origins' => ['*'],

            /*
            |--------------------------------------------------------------------------
            | 请求头认证键名
            |--------------------------------------------------------------------------
            | 客户端请求头需携带token至此键。
            */
            'authorization_key' => 'Authorization',

            /*
            |--------------------------------------------------------------------------
            | 以下配置并不属于本扩展，用于公司内部项目请忽略
            |--------------------------------------------------------------------------
            */
            'except' => true,
            'except_header_key' => 'over',
            'except_header_lists' => [
                'overtrue',
                'overfalse'
            ],
        ],
    ],

];
