<?php

return [
    /*
    |--------------------------------------------------------------------------
    | token存放模型
    |--------------------------------------------------------------------------
    | 如果使用数据库需要配置相应模型.
    |
    */
    'oauth_model' => \App\Models\Admin\JkbOauthToken::class,

    /*
    |--------------------------------------------------------------------------
    | token存放表名
    |--------------------------------------------------------------------------
    | 如果使用数据库需要配置相应表名称.
    |
    */
    'database_table_name' => 'admin_jkb_oauth_token',

    /*
    |--------------------------------------------------------------------------
    | 守卫
    |--------------------------------------------------------------------------
    | 可自定义多个guards
    | eg .
    | Route::middleware('foo')->group(){}
    | Route::middleware('bar')->group(){}
    */
    'guards' => [
        /*
        |--------------------------------------------------------------------------
        | 中间件名称
        |--------------------------------------------------------------------------
        | 可自定义中间件组名称  eg . Route::middleware('jkb')->group(){},可配置多个
        */
        'foo' => [
            /*
            |--------------------------------------------------------------------------
            | 可选驱动
            |--------------------------------------------------------------------------
            | 支持 database|cache.
            */
            'driver' => 'database',

            /*
            |--------------------------------------------------------------------------
            | 缓存标签
            |--------------------------------------------------------------------------
            | 驱动使用缓存可通过分组方便管理.
            */
            'cache_tag' => 'jkb-foo',

            /*
            |--------------------------------------------------------------------------
            | 认证前中间件
            |--------------------------------------------------------------------------
            | 可以在认证前触发自定义中间件
            | eg. [App\Api\Oauth\Middleware\JKBrule::class]
            */
            'before_auth' => [\App\Api\Oauth\Middleware\OringinCheck::class],

            /*
            |--------------------------------------------------------------------------
            | 验证前中间件
            |--------------------------------------------------------------------------
            | 认证完成后在验证用户前触发自定义中间件
            |
            */
            'before_check' => [],

            /*
            |--------------------------------------------------------------------------
            | 缓存时间
            |--------------------------------------------------------------------------
            | 单位秒.
            */
            'cache_expire_time' => 3600,

            /*
            |--------------------------------------------------------------------------
            | retoken
            |--------------------------------------------------------------------------
            | 认证完成后是否清空当前认证用户过往已颁发token.
            */
            'retoken' => true,

            /*
            |--------------------------------------------------------------------------
            | 授信站点
            |--------------------------------------------------------------------------
            | 授信请求website列表.
            */
            'allowed_origins' => ['*'],

            /*
            |--------------------------------------------------------------------------
            | 请求头认证键名
            |--------------------------------------------------------------------------
            | 客户端请求头需携带token至此键.
            */
            'authorization_key' => 'Authorization',

            /*
            |--------------------------------------------------------------------------
            | 赦免令牌
            |--------------------------------------------------------------------------
            | 如果功能设置为开启.服务端可以通过响应 tayloy=>otwell 客户端
            | 客户端请求可通过设置header头 tayloy => otewell 用来绕过验证.
            | 开启此功能并不意味无法拿到认证用户，它仅仅是绕过验证而已(不抛出401异常).
            | 此时request()->user() => null.
            | 后续可以通过中间件加入自己的逻辑达到某种目的
            */
            'except' => true,
            'except_header_key' => 'taylor',
            'except_header_lists' => [
                'otwell',
                'foxriver'
            ],
        ],
        'bar' => [
            /*
            |--------------------------------------------------------------------------
            | 可选驱动
            |--------------------------------------------------------------------------
            | 支持 database|cache.
            */
            'driver' => 'database',

            /*
            |--------------------------------------------------------------------------
            | 缓存标签
            |--------------------------------------------------------------------------
            | 驱动使用缓存可通过分组方便管理.
            */
            'cache_tag' => 'jkb-bar',

            /*
            |--------------------------------------------------------------------------
            | 认证前中间件
            |--------------------------------------------------------------------------
            | 可以在认证前触发自定义中间件
            | eg. [App\Api\Oauth\Middleware\JKBrule::class]
            */
            'before_auth' => [\App\Api\Oauth\Middleware\OringinCheck::class],

            /*
            |--------------------------------------------------------------------------
            | 验证前中间件
            |--------------------------------------------------------------------------
            | 认证完成后在验证用户前触发自定义中间件
            |
            */
            'before_check' => [],

            /*
            |--------------------------------------------------------------------------
            | 缓存时间
            |--------------------------------------------------------------------------
            | 单位秒.
            */
            'cache_expire_time' => 3600,

            /*
            |--------------------------------------------------------------------------
            | retoken
            |--------------------------------------------------------------------------
            | 认证完成后是否清空当前认证用户过往已颁发token.
            */
            'retoken' => true,

            /*
            |--------------------------------------------------------------------------
            | 授信站点
            |--------------------------------------------------------------------------
            | 授信请求website列表.
            */
            'allowed_origins' => ['*'],

            /*
            |--------------------------------------------------------------------------
            | 请求头认证键名
            |--------------------------------------------------------------------------
            | 客户端请求头需携带token至此键.
            */
            'authorization_key' => 'Authorization',

            /*
            |--------------------------------------------------------------------------
            | 赦免令牌
            |--------------------------------------------------------------------------
            | 如果功能设置为开启.服务端可以通过响应 tayloy=>otwell 客户端
            | 客户端请求可通过设置header头 foxriver => overtrue 用来绕过验证.
            | 开启此功能并不意味无法拿到认证用户，它仅仅是绕过验证而已(不抛出401异常).
            | 此时如果认证不通过request()->user() => null.
            | 后续可以通过中间件加入自己的逻辑达到某种目的
            */
            'except' => true,
            'except_header_key' => 'foxriver',
            'except_header_lists' => [
                'overtrue',
            ],
        ],
    ],

];
